# ─────────────────────────────────────────────────────────────────────────────
#  Tauroi Prediction Engine — Docker Compose
# ─────────────────────────────────────────────────────────────────────────────
#  Usage:
#    docker compose up              # single scan run
#    docker compose up tauroi-loop  # continuous market-making loop
#
#  Secrets are read from .env (never baked into the image).
#  The cache/ volume persists Kalshi HF data between runs.
# ─────────────────────────────────────────────────────────────────────────────

services:
  # Single execution (for cron / GitHub Actions / manual)
  tauroi:
    build: .
    env_file: .env
    volumes:
      - ./signals:/app/signals
      - ./cache:/app/cache

  # Continuous loop (for a dedicated server / VM)
  tauroi-loop:
    build: .
    env_file: .env
    command: ["python", "main.py", "--belief", "--scan", "--live", "--market-making", "--loop", "--interval", "60"]
    restart: unless-stopped
    volumes:
      - ./signals:/app/signals
      - ./cache:/app/cache
